<!DOCTYPE html>
{% load static %}
<html>
  <head>
    <!-- Import Files -->
    <link rel="stylesheet" type="text/css" href="{% static "main.css" %}"/>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.5/jquery.min.js"></script>
  </head>

  <body background="http://shopsocially.com/wp-content/uploads/2014/10/Grey-Background-48.jpg">
    <!-- Div that holds all machines -->
    Button to rescan for network topology
    <div id="machines" class="out">
    </div>
  </body>


  <!-- Dynamically generate machines in database -->
  <script>
  window.onload=function()
  {

    var machines = document.getElementById('machines');
    var i=1;
      {% for machine in machines %}
      //div for machine overall
      var machine = document.createElement("div");
      var name = "machine"+i;
      machine.setAttribute("style", "width: 100px");
      machine.setAttribute("id", name);
      machine.setAttribute("class", "machineDiv");
      //link to info about machine
      var machine_link = document.createElement("a")
      machine_link.setAttribute("href", "machine/{{machine.ip}}")

      //image for machine
      var machine_picture = document.createElement("img")

      //Check threat level and match it with the right image
      if({{machine.number_of_threats}} < 5)
      {
        //machine_picture.setAttribute("src", "{% static "green-square" %}");
        machine_picture.setAttribute("src", "{% static "green-square.png" %}");
      }

      else if({{machine.number_of_threats}} < 10 && {{machine.number_of_threats}} >= 5)
      {
        //machine_picture.setAttribute("src", "{% static "yellow-square" %}");
        machine_picture.setAttribute("src", "{% static "yellow-square.png" %}");
      }

      if({{machine.number_of_threats}} < 15 && {{machine.number_of_threats}} >= 10)
      {
        //machine_picture.setAttribute("src", "{% static "orange-square" %}");
        machine_picture.setAttribute("src", "{% static "orange-square.png" %}");
      }

      if({{machine.number_of_threats}} >= 15)
      {
        machine_picture.setAttribute("src", "{% static "red-square.png" %}");
      }

      machine_picture.setAttribute("height", "100");
      machine_picture.setAttribute("width", "100");

      //div for machine info
      var machine_info = document.createElement("div");
      machine_info.setAttribute("id", "machine_info"+i);
      machine_info.innerHTML="{{machine.name}}\n{{machine.ip}}";

      //Append machine info and image to a machine
      machine_link.appendChild(machine_picture);

      machine.appendChild(machine_link);
      machine.appendChild(machine_info);
      //Append machine to machines
      machines.appendChild(machine);
      i++;
      {%endfor%}
    }
  </script>
</html>
